<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>weiner</title>

    <!-- <link rel="stylesheet" href="stylesheets/styles.css"> -->
    <style>
        #body h1:first-child{ display:none }
        footer { font-size:0.8em; text-align:right }
        a, a:visited {  text-decoration:none }
    </style>
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
    <div class="wrapper">
      <header>
      <h1><a href="#!/index.md">V2U</a></h1>
      </header>
      <section id="body">
        &gt; loading...
      </section>
    </div>
    <footer>
      <p>Hosted on GitHub Pages </p>
    </footer>
    
    <script src="javascripts/zepto.min.js"></script>
    <script src="javascripts/marked.js"></script>
    <script>
        var stripUrl = function(url){
            var match = url.match(/#!(.+)$/);  
            return match ? match[1] : "/index.md";
        };
        var parseBody = function(body){
            $('#body').html(marked.parse(body));
            var title = $('#body>h1').text();   
            if(title) document.title = title;
            else document.title = page
        };
        var getPage = function(page){
            page = stripUrl(decodeURIComponent(page));
            $.ajax({
              type: "GET",
              url: "pages/"+page,
              success: parseBody,
              error: function(d) { parseBody("# 404\n页面丢了……"); }
            });
        };

        window.onhashchange = function(){
            $('#body').html('> loading...');
            getPage(location.hash);  
        };

        getPage(location.hash);
    </script>
  </body>
</html>
